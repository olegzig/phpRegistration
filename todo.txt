Понятия не имею как изменить is-valid который был после сабмита. Разве что ручками стили менять (а не классы). И в половине случаев он работает, чтобы это не значило

Надо переписать взаимодействие с JS. Нельзя юзать donjajo/php-jsondb. Наверное. Это же фреймворк? Судя по всему нет, а значит можно.
Insecure sites can't set cookies with the 'secure' directive. - но всё работает